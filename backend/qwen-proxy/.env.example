# ============================================================================
# Qwen Proxy Backend - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control!
# ============================================================================

# ----------------------------------------------------------------------------
# Environment
# ----------------------------------------------------------------------------
NODE_ENV=development

# ----------------------------------------------------------------------------
# Server Configuration
# ----------------------------------------------------------------------------
PORT=3000
TRUST_PROXY=false

# ----------------------------------------------------------------------------
# Qwen API Credentials (OPTIONAL - Can be configured via dashboard)
# ----------------------------------------------------------------------------
# NOTE: Credentials are now stored in the centralized database and can be
# configured through the dashboard UI at http://localhost:3001/settings
#
# You can still set these environment variables as a fallback, but it's
# recommended to use the dashboard instead. The server will start successfully
# even without credentials - you can configure them later through the UI.
#
# If you want to use environment variables instead of the database:
# 1. Open https://chat.qwen.ai in your browser
# 2. Open DevTools (F12) -> Network tab
# 3. Make a chat request and inspect the headers
# 4. Copy the 'bx-umidtoken' header value to QWEN_TOKEN
# 5. Copy the complete 'Cookie' header value to QWEN_COOKIES

# QWEN_TOKEN=your-bx-umidtoken-here
# QWEN_COOKIES=your-cookie-string-here

# Qwen API settings
QWEN_TIMEOUT=60000               # Request timeout in milliseconds (default: 60 seconds)

# User-Agent header (optional, uses default Chrome user agent if not set)
# USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36

# ----------------------------------------------------------------------------
# Session Management
# ----------------------------------------------------------------------------
# How long to keep conversation sessions active after last use
SESSION_TIMEOUT=1800000           # 30 minutes in milliseconds

# How often to clean up expired sessions
SESSION_CLEANUP_INTERVAL=600000   # 10 minutes in milliseconds

# ----------------------------------------------------------------------------
# Logging Configuration
# ----------------------------------------------------------------------------
# Log level: error, warn, info, http, verbose, debug
LOG_LEVEL=info

# Log directory (default: logs)
LOG_DIR=logs

# Maximum log file size in bytes (default: 10MB)
LOG_MAX_SIZE=10485760

# Maximum number of log files to keep (default: 5)
LOG_MAX_FILES=5

# Pretty print logs in development (default: true)
LOG_PRETTY=true

# ----------------------------------------------------------------------------
# Security Settings
# ----------------------------------------------------------------------------
# CORS configuration
CORS_ENABLED=true
CORS_ORIGIN=*                    # Set to specific origin in production (e.g., https://your-app.com)
CORS_CREDENTIALS=false

# ----------------------------------------------------------------------------
# Retry Configuration
# ----------------------------------------------------------------------------
# Retry settings for failed Qwen API requests
RETRY_MAX_ATTEMPTS=3              # Maximum number of retries
RETRY_INITIAL_DELAY=1000          # Initial delay before first retry (milliseconds)
RETRY_MAX_DELAY=10000             # Maximum delay between retries (milliseconds)
RETRY_BACKOFF_MULTIPLIER=2        # Exponential backoff multiplier

# ----------------------------------------------------------------------------
# Cache Configuration
# ----------------------------------------------------------------------------
# How long to cache the models list from Qwen API
MODELS_CACHE_DURATION=300000      # 5 minutes in milliseconds

# ----------------------------------------------------------------------------
# Tool Calling Configuration
# ----------------------------------------------------------------------------
# Enable tool calling transformation (OpenAI tool calls <-> Qwen XML format)
# When enabled, OpenAI tool definitions are transformed to XML format in system prompt
# and Qwen XML responses are parsed back to OpenAI tool_calls format
# Default: true
ENABLE_TOOL_CALLING=true
